# -*- coding: utf-8 -*-
# ---------------------------------------------------------------------------
# income_growth.py
# Created on: 2017-03-08 14:29:22.00000
#   (generated by ArcGIS/ModelBuilder)
# Description: 
# ---------------------------------------------------------------------------

# Set the necessary product code
# import arcinfo


# Import arcpy module
import arcpy


# Local variables:
Neighborhoods = "Neighborhoods"
Census_Tract = "Census_Tract"
Census_Tract__2_ = Census_Tract
CT_MHI_Race_ = "G:\\DC Policy Center\\Income Growth\\Data\\Tab\\Income_Growth_R\\Race.xlsx\\CT_MHI_Race$"
Census_Tract_Income = Census_Tract__2_
CT_MHI_Age_ = "G:\\DC Policy Center\\Income Growth\\Data\\Tab\\Income_Growth_R\\Age.xlsx\\CT_MHI_Age$"
Census_Tract_Income__2_ = "G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Census_Tract_Income"
Income_Point = "G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point"
Neighborhoods_SpatialJoin = "G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Neighborhoods_SpatialJoin"
Neighborhoods_SpatialJoin__2_ = "Neighborhoods_SpatialJoin"
Neighborhoods_SpatialJoin__4_ = Neighborhoods_SpatialJoin__2_
Neighborhoods_SpatialJoin__5_ = Neighborhoods_SpatialJoin__4_
Neighborhoods_SpatialJoin__6_ = Neighborhoods_SpatialJoin__5_
Neighborhoods_SpatialJoin__7_ = Neighborhoods_SpatialJoin__6_
Neighborhoods_SpatialJoin__8_ = Neighborhoods_SpatialJoin__7_
Neighborhoods_SpatialJoin__9_ = Neighborhoods_SpatialJoin__8_
Neighborhoods_SpatialJoin__10_ = Neighborhoods_SpatialJoin__9_
Neighborhoods_SpatialJoin__11_ = Neighborhoods_SpatialJoin__10_
Neighborhoods_SpatialJoin__12_ = Neighborhoods_SpatialJoin__11_
Neighborhoods_SpatialJoin__13_ = Neighborhoods_SpatialJoin__12_
Neighborhoods_SpatialJoin__14_ = Neighborhoods_SpatialJoin__13_
Neighborhoods_SpatialJoin__15_ = Neighborhoods_SpatialJoin__14_
Neighborhoods_SpatialJoin__16_ = Neighborhoods_SpatialJoin__15_
Neighborhoods_SpatialJoin__17_ = Neighborhoods_SpatialJoin__16_
Neighborhoods_SpatialJoin__18_ = Neighborhoods_SpatialJoin__17_
Neighborhoods_SpatialJoin__3_ = Neighborhoods_SpatialJoin__18_
Neighborhoods_SpatialJoin__20_ = Neighborhoods_SpatialJoin__3_
Neighborhoods_SpatialJoin__21_ = Neighborhoods_SpatialJoin__20_

# Add Race Table
arcpy.AddJoin_management(Census_Tract, "GEOID", CT_MHI_Race_, "GEOID", "KEEP_ALL")

# Add Age Table
arcpy.AddJoin_management(Census_Tract__2_, "Census_Tract.GEOID", CT_MHI_Age_, "GEOID", "KEEP_ALL")

# Export to perminent shapefile
arcpy.CopyFeatures_management(Census_Tract_Income, Census_Tract_Income__2_, "", "0", "0", "0")

# Convert Census Tracts to centroid points
arcpy.FeatureToPoint_management(Census_Tract_Income__2_, Income_Point, "CENTROID")

# Join Census Tract Data to Neighborhood Boudaries
arcpy.SpatialJoin_analysis(Neighborhoods, Income_Point, Neighborhoods_SpatialJoin, "JOIN_ONE_TO_ONE", "KEEP_ALL", "N_Cluster \"N_Cluster\" true true false 50 Text 0 0 ,First,#,Neighborhoods,N_Cluster,-1,-1;FIRST_N_Name \"FIRST_N_Name\" true true false 50 Text 0 0 ,First,#,Neighborhoods,FIRST_N_Name,-1,-1;SHAPE_Length \"SHAPE_Length\" false true true 8 Double 0 0 ,First,#,Neighborhoods,SHAPE_Length,-1,-1;SHAPE_Area \"SHAPE_Area\" false true true 8 Double 0 0 ,First,#,Neighborhoods,SHAPE_Area,-1,-1;Census_Tract_GEOID \"Census_Tract_GEOID\" true true false 11 Text 0 0 ,First,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,Census_Tract_GEOID,-1,-1;Census_Tract_NAMELSAD \"Census_Tract_NAMELSAD\" true true false 20 Text 0 0 ,First,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,Census_Tract_NAMELSAD,-1,-1;Census_Tract_ALAND \"Census_Tract_ALAND\" true true false 8 Double 0 0 ,First,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,Census_Tract_ALAND,-1,-1;Census_Tract_AWATER \"Census_Tract_AWATER\" true true false 8 Double 0 0 ,First,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,Census_Tract_AWATER,-1,-1;Census_Tract_INTPTLAT \"Census_Tract_INTPTLAT\" true true false 11 Text 0 0 ,First,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,Census_Tract_INTPTLAT,-1,-1;Census_Tract_INTPTLON \"Census_Tract_INTPTLON\" true true false 12 Text 0 0 ,First,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,Census_Tract_INTPTLON,-1,-1;Census_Tract_N_Cluster \"Census_Tract_N_Cluster\" true true false 50 Text 0 0 ,First,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,Census_Tract_N_Cluster,-1,-1;Census_Tract_N_Name \"Census_Tract_N_Name\" true true false 50 Text 0 0 ,First,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,Census_Tract_N_Name,-1,-1;CT_MHI_Race__GEOID \"CT_MHI_Race__GEOID\" true true false 255 Text 0 0 ,First,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Race__GEOID,-1,-1;MHI_Race_09 \"MHI_Race_09\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Race__MHI_ALL_09,-1,-1;MHI_Race_15 \"MHI_Race_15\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Race__MHI_ALL_15,-1,-1;MHI_Black_09 \"MHI_Black_09\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Race__MHI_Black_09,-1,-1;MHI_Black_15 \"MHI_Black_15\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Race__MHI_Black_15,-1,-1;MHI_White_09 \"MHI_White_09\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Race__MHI_White_09,-1,-1;MHI_White_15 \"MHI_White_15\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Race__MHI_White_15,-1,-1;MHI_Hispanic_09 \"MHI_Hispanic_09\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Race__MHI_Hispanic_09,-1,-1;MHI_Hispanic_15 \"MHI_Hispanic_15\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Race__MHI_Hispanic_15,-1,-1;MHI_Asian_09 \"MHI_Asian_09\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Race__MHI_Asian_09,-1,-1;MHI_Asian_15 \"MHI_Asian_15\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Race__MHI_Asian_15,-1,-1;All_Change \"All_Change\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Race__All_Change,-1,-1;Black_Change \"Black_Change\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Race__Black_Change,-1,-1;White_Change \"White_Change\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Race__White_Change,-1,-1;Hispanic_Change \"Hispanic_Change\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Race__Hispanic_Change,-1,-1;Asian_Change \"Asian_Change\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Race__Asian_Change,-1,-1;MHI_ALL_09 \"MHI_ALL_09\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Age__MHI_ALL_09,-1,-1;MHI_U25_09 \"MHI_U25_09\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Age__MHI_U25_09,-1,-1;MHI_25_44_09 \"MHI_25_44_09\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Age__MHI_25_44_09,-1,-1;MHI_45_64_09 \"MHI_45_64_09\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Age__MHI_45_64_09,-1,-1;MHI_65P_09 \"MHI_65P_09\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Age__MHI_65P_09,-1,-1;MHI_ALL_15 \"MHI_ALL_15\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Age__MHI_ALL_15,-1,-1;MHI_U25_15 \"MHI_U25_15\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Age__MHI_U25_15,-1,-1;MHI_25_44_15 \"MHI_25_44_15\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Age__MHI_25_44_15,-1,-1;MHI_45_64_15 \"MHI_45_64_15\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Age__MHI_45_64_15,-1,-1;MHI_65P_15 \"MHI_65P_15\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Age__MHI_65P_15,-1,-1;MHI_ALL_Change \"MHI_ALL_Change\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Age__MHI_ALL_Change,-1,-1;MHI_U25_Change \"MHI_U25_Change\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Age__MHI_U25_Change,-1,-1;MHI_25_44_Change \"MHI_25_44_Change\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Age__MHI_25_44_Change,-1,-1;MHI_45_64_Change \"MHI_45_64_Change\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Age__MHI_45_64_Change,-1,-1;MHI_65P_Change \"MHI_65P_Change\" true true false 8 Double 6 15 ,Mean,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,CT_MHI_Age__MHI_65P_Change,-1,-1;ORIG_FID \"ORIG_FID\" true true false 0 Long 0 0 ,First,#,G:\\DC Policy Center\\Income Growth\\Data\\Spatial Data\\Income_Growth.gdb\\Income_Point,ORIG_FID,-1,-1", "INTERSECT", "", "")

# Calculate New Percent Change in Incomes
arcpy.SelectLayerByAttribute_management(Neighborhoods_SpatialJoin__2_, "NEW_SELECTION", "MHI_Race_09 IS NOT NULL OR MHI_Race_15 IS NOT NULL")

# Calculate New Percent Change in Incomes
arcpy.CalculateField_management(Neighborhoods_SpatialJoin__4_, "All_Change", "([MHI_Race_15] - [MHI_Race_09]) / [MHI_Race_09] * 100", "VB", "")

# Calculate New Percent Change in Incomes
arcpy.SelectLayerByAttribute_management(Neighborhoods_SpatialJoin__5_, "NEW_SELECTION", "MHI_Black_09 IS NOT NULL OR MHI_Black_15 IS NOT NULL")

# Calculate New Percent Change in Incomes
arcpy.CalculateField_management(Neighborhoods_SpatialJoin__6_, "Black_Change", "( [MHI_Black_15]- [MHI_Black_09]) / [MHI_Black_09] * 100", "VB", "")

# Calculate New Percent Change in Incomes
arcpy.SelectLayerByAttribute_management(Neighborhoods_SpatialJoin__7_, "NEW_SELECTION", "MHI_White_15 IS NOT NULL OR MHI_White_09 IS NOT NULL")

# Calculate New Percent Change in Incomes
arcpy.CalculateField_management(Neighborhoods_SpatialJoin__8_, "White_Change", "( [MHI_White_15]- [MHI_White_09]) / [MHI_White_09] * 100", "VB", "")

# Calculate New Percent Change in Incomes
arcpy.SelectLayerByAttribute_management(Neighborhoods_SpatialJoin__9_, "NEW_SELECTION", "MHI_Hispanic_15 IS NOT NULL AND MHI_Hispanic_09 IS NOT NULL")

# Calculate New Percent Change in Incomes
arcpy.CalculateField_management(Neighborhoods_SpatialJoin__10_, "Hispanic_Change", "( [MHI_Hispanic_15]- [MHI_Hispanic_09]) / [MHI_Hispanic_09] * 100", "VB", "")

# Calculate New Percent Change in Incomes
arcpy.SelectLayerByAttribute_management(Neighborhoods_SpatialJoin__11_, "NEW_SELECTION", "MHI_Asian_15 IS NOT NULL OR MHI_Asian_09 IS NOT NULL")

# Calculate New Percent Change in Incomes)
arcpy.CalculateField_management(Neighborhoods_SpatialJoin__12_, "Asian_Change", "( [MHI_Asian_15]- [MHI_Asian_09]) / [MHI_Asian_09] * 100", "VB", "")

# Calculate New Percent Change in Incomes
arcpy.SelectLayerByAttribute_management(Neighborhoods_SpatialJoin__13_, "NEW_SELECTION", "MHI_U25_09 IS NOT NULL OR MHI_U25_15 IS NOT NULL")

# Calculate New Percent Change in Incomes
arcpy.CalculateField_management(Neighborhoods_SpatialJoin__14_, "MHI_U25_Change", "( [MHI_U25_15]- [MHI_U25_09]) / [MHI_U25_09] * 100", "VB", "")

# Calculate New Percent Change in Incomes
arcpy.SelectLayerByAttribute_management(Neighborhoods_SpatialJoin__15_, "NEW_SELECTION", "MHI_25_44_15 IS NOT NULL OR MHI_25_44_09 IS NOT NULL")

# Calculate New Percent Change in Incomes
arcpy.CalculateField_management(Neighborhoods_SpatialJoin__16_, "MHI_25_44_Change", "( [MHI_25_44_15] - [MHI_25_44_09]) / [MHI_25_44_09] * 100", "VB", "")

# Calculate New Percent Change in Incomes
arcpy.SelectLayerByAttribute_management(Neighborhoods_SpatialJoin__17_, "NEW_SELECTION", "MHI_45_64_15 IS NOT NULL OR MHI_45_64_09 IS NOT NULL")

# Calculate New Percent Change in Incomes
arcpy.CalculateField_management(Neighborhoods_SpatialJoin__18_, "MHI_45_64_Change", "( [MHI_45_64_15] - [MHI_45_64_09]) / [MHI_45_64_09] * 100", "VB", "")

# Calculate New Percent Change in Incomes
arcpy.SelectLayerByAttribute_management(Neighborhoods_SpatialJoin__3_, "NEW_SELECTION", "MHI_65P_15 IS NOT NULL OR MHI_65P_09 IS NOT NULL")

# Calculate New Percent Change in Incomes
arcpy.CalculateField_management(Neighborhoods_SpatialJoin__20_, "MHI_65P_Change", "( [MHI_65P_15] - [MHI_65P_09]) / [MHI_65P_09] * 100", "VB", "")

